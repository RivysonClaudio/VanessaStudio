<div class="client-header">
    <a class="return-clientList" routerLink="/admin/clientes">
        <svg xmlns="http://www.w3.org/2000/svg" height="36px" viewBox="0 -960 960 960" width="36px" fill="#F25C93">
                <path d="M360-240 120-480l240-240 56 56-144 144h568v80H272l144 144-56 56Z"/>
        </svg>
    </a>
    <div class="header-title">
        <h2>{{title}}</h2>
    </div>
    <div class="Empty-Space"></div>
</div>
<hr>
<div class="clientRegister-content ">
    <div class="space-bar"><h5>CADASTRO {{today}}</h5></div>
    <div class="client-content-register">
        <form [formGroup]="form" (ngSubmit)="onSubmit()" autocomplete="off">
            <div class="client-information-text-inner-grid">
                <legend>Informações do Cliente</legend>
                <div><input type="text" formControlName="clientName"   id="clientName"     placeholder="Nome"   ></div>
                <div><input type="text" formControlName="clientNick"   id="clientNick"     placeholder="Apelido"></div>
                <div><input type="text" formControlName="clientPhone1" id="clientPhone1"   placeholder="Telefone Principal"></div>
                <div><input type="text" formControlName="clientPhone2" id="clientPhone2"   placeholder="Telefone 2"></div>
                <div><input type="text" formControlName="clientPhone3" id="clientPhone3"   placeholder="Telefone 3"></div>
                <div><input type="text" formControlName="clientBirth"  id="clientBirth"    placeholder="Data de Nascimento"></div>
            </div>

            <div class="client-address-information-text-inner-grid">
                <legend>Endereço</legend>
                <div><input type="text" formControlName="clientStreet"         id="clientStreet"       placeholder="Logradouro">   </div>
                <div><input type="text" formControlName="clientPostcode"       id="clientPostcode"     placeholder="CEP">          </div>
                <div><input type="text" formControlName="clientNeighborhood"   id="clientNeighborhood" placeholder="Bairro">       </div>
                <div><input type="text" formControlName="clientCity"           id="clientCity"         placeholder="Cidade">       </div>
            </div>

            <div class="clientProfilePictureExpanded">
                <img [src]="imagePreviewSrc || 'images/standard-profile-picture.jpg'" alt="Foto do Cliente" (click)="photoInput.click()">
                <input #photoInput type="file" formControlName="clientPhotoForm" id="clientPhotoForm" accept="image/jpeg" (change)="onFileSelected($event)">
                @if (imagePreviewSrc != "images/standard-profile-picture.jpg") {
                    <span (click)="deleteImage()">Excluir</span>
                }
            </div>
        </form>
    </div>
    @if (routerType == 'edit'){
        <div class="client-services-field">
            @if (billsList == null){
                <legend>Nenhum serviço encontrado para este cliente</legend>
            }
            @else {
                <div class="client-services-infos">
                    <div class="client-services-resume">
                        <h3>Última visita: {{billsList.length ? billsList[billsList.length - 1].dataComanda?.split('T')[0].split('-').reverse().join('/') : ''}}</h3>
                        <h3>Atendida(o) mais vezes por: {{professionalMode}}</h3>
                        <h3>Proxima renovação em: {{nearestRenew.split('-').reverse().join('/')}}</h3>
                        <h3>{{serviceToBeRenewed}}</h3>
                        <h1>{{clientBillsTotalValue}}</h1>
                    </div>
                    <div class="client-services-details">
                        <ul>
                            @if (billsList) {
                                @for (item of billsList; track $index) {
                                    @for (service of item.servicosComandas; track $index) {
                                        <li>
                                            @if(item.statusComanda == "CANCELADA"){ <div style="background-color: #F39F8C"></div> }
                                            @if(item.statusComanda == "FINALIZADA"){ <div style="background-color: #B8F09E"></div> }
                                            @if(item.statusComanda == "AGENDADA"){ <div style="background-color: #BFE4EC"></div> }
                                            <span>Comanda: {{item.numeroSerie}}</span>
                                            <span>{{item.dataComanda.split('T')[0].split('-').reverse().join('/')}}</span>
                                            <span>{{service.categoriaServico}}</span>
                                            <span>{{service.descricaoServico}}</span>
                                            <button [routerLink]="['/admin/comandas/consulta/', item.numeroSerie]">ver comanda</button>
                                        </li>
                                    }
                                }
                            }
                        </ul>
                    </div>
                </div>
            }
        </div>
    }
    <div class="space-bar">
        @if (routerType == 'register'){
            <a routerLink="/clientes"><button>Cancelar</button></a>
            <button (click)="onSubmit()">Salvar</button>
        }
        @else if (routerType == 'edit'){
            <button (click)="onDelete()">Excluir</button>
            <button (click)="onEdit()">Editar</button>
        }
    </div>
</div>